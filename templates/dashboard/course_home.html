{% extends 'dashboard/base.html' %}
 {% load static %} 
 {% block title %}
 Student
{% endblock %}

 {% block content %}
<div class="app-wrapper">
	    
	    <div class="app-content pt-3 p-md-3 p-lg-4">
		    <div class="container-xl">
			    
			    <div class="d-flex justify-content-between align-items-center mb-4">
				    <h1 class="app-page-title mb-0"><i class="fas fa-graduation-cap me-2"></i>Courses</h1>
				    <div class="d-flex align-items-center gap-3">
					    <div class="input-group" style="max-width: 300px;">
						    <span class="input-group-text border-0 bg-transparent"><i class="fas fa-search text-muted"></i></span>
						    <input type="text" id="courses-search" class="form-control border-0 shadow-none" placeholder="Search coursesâ€¦" autocomplete="off" />
						    <button type="button" class="btn btn-link px-2 clear-search" hidden><i class="fas fa-times-circle text-muted"></i></button>
					    </div>
				        <a class="btn app-btn-primary text-nowrap" href="{% url 'add_activity' %}"><i class="fas fa-plus me-2"></i>Create New Course</a>
				    </div>
			    </div>
				
				
				<div class="tab-content" id="orders-table-tab-content">
			        <div class="tab-pane fade show active" id="orders-all" role="tabpanel" aria-labelledby="orders-all-tab">
					    <div class="app-card app-card-orders-table shadow-sm mb-5">
						    <div class="app-card-body">
							    <div class="table-responsive">
							        <table id="courses-table" class="table app-table-hover mb-0 text-left">
										<thead>
											<tr>
												<th class="cell" style="width: 5%;">ID</th>
												<th class="cell" style="width: 8%;">Image</th>
												<th class="cell" style="width: 20%;">Course Title</th>
												<th class="cell" style="width: 25%;">Description</th>
												<th class="cell" style="width: 10%;">Schedule</th>
												<th class="cell" style="width: 8%;">Cost</th>
												<th class="cell" style="width: 10%;">Participants</th>
												<th class="cell" style="width: 14%;">Actions</th>
											</tr>
										</thead>
										<tbody>
											{% for extra_activity in extra_activities %}
											<tr>
												<td class="cell">
													<span class="badge bg-secondary">#{{ extra_activity.id }}</span>
												</td>
												<td class="cell">
													{% if extra_activity.image %}
														<img src="{{ extra_activity.image.url }}" alt="{{ extra_activity.title }}" 
															 class="rounded" style="width: 50px; height: 50px; object-fit: cover;">
													{% else %}
														<div class="bg-secondary text-white rounded d-flex align-items-center justify-content-center" 
															 style="width: 50px; height: 50px;">
															<i class="fas fa-graduation-cap"></i>
														</div>
													{% endif %}
												</td>
												<td class="cell">
													<div class="d-flex flex-column">
														<strong>{{ extra_activity.title|truncatewords:5 }}</strong>
													</div>
												</td>
												<td class="cell">
													<small class="text-muted">{{ extra_activity.description|truncatewords:12 }}</small>
												</td>
												<td class="cell">
													<div class="d-flex flex-column">
														<small>
															<i class="fas fa-calendar-alt text-primary me-1"></i>
															<strong>Start:</strong> {{ extra_activity.start_time|date:"M d, Y" }}
														</small>
														<small class="text-muted">{{ extra_activity.start_time|time:"h:i A" }}</small>
														<small class="mt-1">
															<i class="fas fa-calendar-check text-success me-1"></i>
															<strong>End:</strong> {{ extra_activity.end_time|date:"M d, Y" }}
														</small>
													</div>
												</td>
												<td class="cell">
													{% if extra_activity.cost == 0 %}
														<span class="badge bg-success">
															<i class="fas fa-gift me-1"></i>FREE
														</span>
													{% else %}
														<span class="badge bg-warning text-dark">
															<i class="fas fa-rupee-sign me-1"></i>Rs. {{ extra_activity.cost }}
														</span>
													{% endif %}
												</td>
												<td class="cell">
													<div class="d-flex align-items-center">
														<i class="fas fa-users text-info me-2"></i>
														<span class="badge bg-info">{{ extra_activity.participant_count|default:0 }}</span>
													</div>
												</td>
												<td class="cell">
													<a class="btn btn-sm btn-outline-primary" href="{% url 'dashboard:activity_detail' extra_activity.id %}">
														<i class="fas fa-eye me-1"></i>View
													</a>
												</td>
											</tr>
											{% endfor %}
										</tbody>
									</table>
						        </div><!--//table-responsive-->
						       
						    </div><!--//app-card-body-->		
						</div><!--//app-card-->
						
	    
	    
{% endblock %} 
{% block extra_scripts %}
<script src="{% static 'dashboard/assets/plugins/popper.min.js' %}"></script>
<script src="{% static 'dashboard/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>

<!-- Page Specific JS -->
<script src="{% static 'dashboard/assets/js/app.js' %}"></script>

<script>
	// Lightweight client-side search
	document.addEventListener('DOMContentLoaded', function() {
		const searchInput = document.getElementById('courses-search');
		const clearBtn = document.querySelector('.clear-search');
		const table = document.getElementById('courses-table');

		if (searchInput && table) {
			searchInput.addEventListener('input', function() {
				const query = this.value.toLowerCase().trim();
				if (clearBtn) clearBtn.hidden = !query;

				const rows = table.querySelectorAll('tbody tr');
				rows.forEach(row => {
					const text = row.textContent.toLowerCase();
					row.style.display = text.includes(query) ? '' : 'none';
				});
			});

			if (clearBtn) {
				clearBtn.addEventListener('click', function() {
					searchInput.value = '';
					searchInput.dispatchEvent(new Event('input'));
					searchInput.focus();
				});
			}
		}
	});
</script>
{% endblock %}
