{% extends 'dashboard/base.html' %}
{% load static %}
{% block title %}Payment Methods - Course Management{% endblock %}
{% block content %}
<div class="app-wrapper">

	<div class="app-content pt-3 p-md-3 p-lg-4">
		<div class="container-xl">
			{% for message in messages %}
			<div class="alert alert-modern alert-dismissible fade show" role="alert">
				<div class="d-flex align-items-center">
					<i class="fas fa-info-circle me-3 fs-5"></i>
					<div class="flex-grow-1">{{ message }}</div>
				</div>
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
			{% endfor %}
			<div class="d-flex justify-content-between align-items-center mb-4">
				<h1 class="app-page-title mb-0">
					<i class="fas fa-credit-card me-2"></i>Payment Methods
				</h1>
				<div class="d-flex align-items-center gap-3">
					<a class="btn app-btn-primary text-nowrap" href="{% url 'dashboard:add_payment_method' %}">
						<i class="fas fa-plus me-1"></i>Add Payment Method
					</a>
				</div>
			</div>

			<div class="tab-content" id="payment-methods-content">
				<div class="tab-pane fade show active" id="payment-methods-all" role="tabpanel">
					{% if payment_methods %}
					<div class="row g-4">
						{% for method in payment_methods %}
						<div class="col-12 col-md-6 col-lg-4">
							<div class="app-card app-card-stat shadow-sm h-100">
								<div class="app-card-body p-3 p-lg-4">
									<div class="d-flex justify-content-between align-items-start mb-3">
										<div class="flex-grow-1">
											<div class="d-flex align-items-center mb-2">
												{% if method.image %}
												<img src="{{ method.image.url }}" alt="{{ method.name }}" 
													style="max-width: 80px; max-height: 80px; object-fit: contain;" class="me-3">
												{% endif %}
												<h4 class="mb-0">{{ method.name }}</h4>
											</div>
											<div class="mb-2">
												{% if method.is_active %}
													<span class="badge bg-success text-white">
														<i class="fas fa-check-circle me-1"></i>Active
													</span>
												{% else %}
													<span class="badge bg-secondary text-white">
														<i class="fas fa-times-circle me-1"></i>Inactive
													</span>
												{% endif %}
												<span class="badge bg-info text-white ms-2">
													<i class="fas fa-sort-numeric-down me-1"></i>Order: {{ method.display_order }}
												</span>
											</div>
										</div>
									</div>
									
									<div class="mb-3">
										<p class="mb-2 text-muted small">{{ method.description|truncatewords:20 }}</p>
										
										{% if method.details %}
										<div class="mt-2">
											<strong class="small">Account Details:</strong>
											<div class="small text-muted">
												{% for key, value in method.details.items %}
													<div>{{ key }}: {{ value }}</div>
												{% endfor %}
											</div>
										</div>
										{% endif %}
									</div>
									
									<div class="d-flex gap-2">
										<a href="{% url 'dashboard:payment_method_detail' method.id %}" 
											class="btn btn-sm btn-primary flex-grow-1">
											<i class="fas fa-eye me-1"></i>View
										</a>
										<a href="{% url 'dashboard:edit_payment_method' method.id %}" 
											class="btn btn-sm btn-secondary">
											<i class="fas fa-edit"></i>
										</a>
										<a href="{% url 'dashboard:delete_payment_method' method.id %}" 
											class="btn btn-sm btn-danger"
											onclick="return confirm('Are you sure you want to delete this payment method?')">
											<i class="fas fa-trash"></i>
										</a>
									</div>
									
									<div class="mt-2 small text-muted">
										<div>Created: {{ method.created_at|date:"M d, Y" }}</div>
										<div>By: {{ method.created_by.username }}</div>
									</div>
								</div>
							</div>
						</div>
						{% endfor %}
					</div>
					{% else %}
					<div class="app-card app-card-orders-table shadow-sm mb-5">
						<div class="app-card-body text-center py-5">
							<i class="fas fa-credit-card fa-3x text-muted mb-3"></i>
							<h5 class="text-muted">No Payment Methods Available</h5>
							<p class="text-muted">Add your first payment method to start accepting payments.</p>
							<a href="{% url 'dashboard:add_payment_method' %}" class="btn app-btn-primary mt-3">
								<i class="fas fa-plus me-1"></i>Add Payment Method
							</a>
						</div>
					</div>
					{% endif %}
				</div><!--//tab-pane-->
			</div><!--//tab-content-->


		</div><!--//container-fluid-->
	</div><!--//app-content-->



</div><!--//app-wrapper-->


{% endblock %}
{% block extra_scripts %}
<script src="{% static 'dashboard/assets/plugins/popper.min.js' %}"></script>
<script src="{% static 'dashboard/assets/plugins/bootstrap/js/bootstrap.min.js' %}"></script>

<!-- Page Specific JS -->
<script src="{% static 'dashboard/assets/js/app.js' %}"></script>
{% endblock %}